(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{o:()=>C,Q:()=>P});var t=document.querySelector("#popupProfile"),n=document.querySelector("#popupelements"),o=document.querySelector("#imagePopup"),r=n.querySelector("#elementsForm"),c=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button"),u=(document.querySelector("elements__image"),t.querySelector("#profileClose"),n.querySelector("#elementsClose"),o.querySelector("#imageClose"),document.querySelector(".profile__title"),document.querySelector(".profile__subtitle"),document.querySelector(".popup__form")),a=(t.querySelector("#name"),t.querySelector("#about"),o.querySelector(".popup__picture")),l=o.querySelector(".popup__text"),s=document.querySelector("#elementsTemplate").content,d=document.querySelector(".elements__list"),p=document.querySelector("#imageTitle"),m=document.querySelector("#imageLink"),f=document.querySelectorAll(".popup"),y=elementspopup.querySelector("#addButton"),_=document.querySelector("#deletePopup"),v=(document.querySelector("deletePopupButton"),{baseUrl:"https://nomoreparties.co/v1/plus-cohort-9/",headers:{actualization:"3f443b98-feb1-41de-bdf1-464c3491594e","Content-Type":"application/json"}}),h=function(e){return e.ok?e.json():Promise.reject("Ой, что-то пошло не так: ".concat(e.status))};function S(e){e.classList.add("popup_opened")}function L(e){e.classList.remove("popup_opened")}function b(e){e.target.classList.toggle("elements__like_active")}function g(e){S(_);var t=e.target.closest(".elements__item").getAttribute("data-id");_.setAttribute("data-id",t)}document.addEventListener("click",(function(e){e.target===profilePopup&&profilePopup.classList.remove("popup_opened")})),document.addEventListener("click",(function(e){e.target===elementsPopup&&elementsPopup.classList.remove("popup_opened")})),document.addEventListener("click",(function(e){e.target===imagePopup&&imagePopup.classList.remove("popup_opened")})),document.addEventListener("click",(function(e){e.key===imagePopup&&imagePopup.classList.remove("popup_opened")})),document.addEventListener("keydown",(function(e){27===e.keyCode&&imagePopup.classList.remove("popup_opened")})),document.addEventListener("keydown",(function(e){27===e.keyCode&&elementsPopup.classList.remove("popup_opened")})),document.addEventListener("keydown",(function(e){27===e.keyCode&&profilePopup.classList.remove("popup_opened")}));var k,q=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtons)):(t.disabled=!0,t.classList.add(n.inactives))};function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function C(e){e.reset()}function P(e){e.classList.add("popup__button_inactive"),e.disabled=!0}Promise.all([fetch("".concat(v.apiUrl,"cards"),{headers:v.headers}).then(h),fetch("".concat(v.apiUrl,"users/me"),{headers:v.headers}).then(h)]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(c.push(o.value),!t||c.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(u)throw r}}return c}}(t,n)||function(e,t){if(e){if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=r[0],i=r[1];c.forEach((function(e){var t;t=function(e,t){var n=s.cloneNode(!0),r=n.querySelector("#elementsImage"),c=n.querySelector(".elements__delete-button"),i=n.querySelector(".elements__item"),u=n.querySelector(".elements__like-counter"),d=n.querySelector(".elements__like");return n.querySelector("#elementsTitle").textContent=e.name,r.setAttribute("src",e.link),r.setAttribute("alt",e.name),i.setAttribute("data-id",e._id),function(e,t,n){e.owner._id!==t._id&&n.classList.add("elements__delete-button_hidden")}(e,t,c),e.likes.length>0&&(u.textContent=e.likes.length),e.likes.some((function(e){return e._id===t._id}))&&d.classList.add("elements__like_active"),d.addEventListener("click",(function(t){return function(e,t,n){var o=t._id;e.target.classList.contains("elements__like_active")?function(e){return fetch("".concat(v.apiUrl,"cards/likes/").concat(e),{method:"DELETE",headers:v.headers}).then(h)}(o).then((function(t){b(e),t.likes.length>0?n.textContent=t.likes.length:n.textContent="0"})).catch((function(e){return console.log(e)})):function(e){return fetch("".concat(v.apiUrl,"cards/likes/").concat(e),{method:"PUT",headers:v.headers}).then(h)}(o).then((function(t){n.textContent=t.likes.length,b(e)})).catch((function(e){return console.log(e)}))}(t,e,u)})),n.querySelector("#deleteButton").addEventListener("click",g),r.addEventListener("click",(function(){S(o),a.src=e.link,a.alt=e.name,l.textContent=e.name})),n}(e,i),d.prepend(t)})),updateProfile(i.avatar,i.name,i.about),user=i})).catch((function(e){return console.log(e)})),f.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&L(e),t.target.classList.contains("popup__close")&&L(e)}))})),deletePopupButton.addEventListener("click",(function(){var e=_.getAttribute("data-id"),t=document.querySelector("[data-id='".concat(e,"']"));(function(e){return fetch("".concat(v.apiUrl,"cards/").concat(e),{method:"DELETE",headers:v.headers}).then(h)})(e).then((function(){t.remove(),L(_)})).catch((function(e){return console.log(e)}))})),c.addEventListener("click",(function(){fillProfileInputs(),S(t)})),i.addEventListener("click",(function(){S(n)})),i.addEventListener("click",(function(){S(n)})),u.addEventListener("submit",submitProfileForm),n.addEventListener("submit",(function(e){var t;e.preventDefault(),y.textContent="Подождите...",(t={name:p.value,link:m.value},fetch("".concat(v.apiUrl,"cards"),{method:"POST",headers:v.headers,body:JSON.stringify({name:t.name,link:t.link})}).then(h)).then((function(e){d.prepend(addCard(e,void 0)),C(r),L(n),P(y)})).catch((function(e){return console.log(e)})).finally((function(){return y.textContent="Добавить"}))})),k={formItem:".popup__form",inputItem:".popup__item",buttons:".popup__button",inactiveButtons:"popup__button_inactive",inputErrorClass:"popup__item-error",errorClass:"popup__input-error"},Array.from(document.querySelectorAll(k.formItem)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputItem)),o=e.querySelector(t.buttons);q(n,o,t),n.forEach((function(r){r.addEventListener("keyup",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var o=e.querySelector("#".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,n):function(e,t,n,o){var r=e.querySelector("#".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.classList.add(o.errorMessageClass),r.textContent=n}(e,t,t.validationtext,n)}(e,r,t),q(n,o,t)}))}))}(e,k)}))})();